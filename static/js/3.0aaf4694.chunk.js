/*! For license information please see 3.0aaf4694.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkprix_du_public=self.webpackChunkprix_du_public||[]).push([[3],{1996:(e,s,t)=>{t.d(s,{b:()=>m});var r=t(5043),a=t(3944),l=t(1639);const i=(0,l.A)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),n=(0,l.A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var o=t(5088),c=t(7118),d=t(579);const m=e=>{let{title:s,director:t,duration:l,year:m,country:x,synopsis:h,posterUrl:u,rating:p=0,voteCount:f=0,isFavorite:y=!1,userVote:g,hasVoted:j=!1,onVote:v,onFavorite:b,onClick:w,className:N=""}=e;const[A,k]=(0,r.useState)(!1),[C,E]=(0,r.useState)(g||p),S=e=>{const s=Math.floor(e/60),t=e%60;return s>0?`${s}h${t>0?t:""}`:`${t}min`};return(0,d.jsxs)("div",{className:`film-card-enhanced bg-white rounded-xl shadow-lg overflow-hidden cursor-pointer ${N}`,onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),onClick:w,children:[(0,d.jsxs)("div",{className:"relative h-48 overflow-hidden",children:[u?(0,d.jsx)("img",{src:u,alt:`Affiche de ${s}`,className:"w-full h-full object-cover transition-transform duration-500",style:{transform:A?"scale(1.1)":"scale(1)"}}):(0,d.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-primary-100 to-secondary-100 flex items-center justify-center",children:(0,d.jsx)(i,{className:"w-12 h-12 text-primary-600"})}),(0,d.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent transition-opacity duration-300 "+(A?"opacity-100":"opacity-0"),children:(0,d.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 text-white transform transition-transform duration-300 ${ hovered ? 'translate-y-0' : 'translate-y-full' }",children:(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:S(l)}),(0,d.jsx)("button",{onClick:e=>{e.stopPropagation(),null===b||void 0===b||b()},className:"p-2 rounded-full transition-colors "+(y?"bg-red-500 text-white":"bg-white/20 text-white hover:bg-red-500"),"aria-label":y?"Retirer des favoris":"Ajouter aux favoris",children:(0,d.jsx)(n,{className:"w-4 h-4",fill:y?"currentColor":"none"})})]})})}),(0,d.jsx)("div",{className:"absolute top-3 left-3",children:(0,d.jsx)("span",{className:"badge badge-primary text-xs font-medium",children:m})}),(0,d.jsx)("div",{className:"absolute top-3 right-3",children:(0,d.jsx)("span",{className:"badge badge-secondary text-xs font-medium",children:x})})]}),(0,d.jsxs)("div",{className:"p-4",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1 line-clamp-1",children:s}),(0,d.jsxs)("p",{className:"text-sm text-gray-600 mb-3",children:["R\xe9alis\xe9 par ",t]}),(0,d.jsx)("p",{className:"text-sm text-gray-700 mb-4 line-clamp-2",children:h}),(0,d.jsxs)("div",{className:"flex items-center justify-between mb-4 text-sm text-gray-500",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,d.jsx)(o.A,{className:"w-4 h-4"}),(0,d.jsx)("span",{children:S(l)})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,d.jsx)(c.A,{className:"w-4 h-4"}),(0,d.jsxs)("span",{children:[f," vote",f>1?"s":""]})]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Votre note :"}),j&&(0,d.jsx)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"\u2713 Vot\xe9"}),C>0&&(0,d.jsxs)("span",{className:"text-sm text-primary-600 font-medium",children:[C,"/5"]})]}),(0,d.jsx)("div",{className:"star-rating",children:Array.from({length:5},(e,s)=>(0,d.jsx)("button",{onClick:e=>{var t;e.stopPropagation(),E(t=s+1),null===v||void 0===v||v(t)},className:`star transition-all duration-200 ${s<C?"star-filled":"star-empty"} hover:scale-110`,"aria-label":`Noter ${s+1} \xe9toile${s>0?"s":""}`,children:(0,d.jsx)(a.A,{className:"w-5 h-5",fill:s<C?"currentColor":"none"})},s))})]}),p>0&&(0,d.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,d.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,d.jsx)("span",{className:"text-gray-600",children:"Note moyenne :"}),(0,d.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,d.jsx)("span",{className:"font-medium text-gray-900",children:p.toFixed(1)}),(0,d.jsx)(a.A,{className:"w-4 h-4 text-yellow-400",fill:"currentColor"})]})]})})]})]})}},3003:(e,s,t)=>{t.r(s),t.d(s,{SeanceVotePage:()=>v});var r=t(5043),a=t(3216),l=t(3768),i=t(5469),n=t(5088),o=t(7118),c=t(3944);const d=(0,t(1639).A)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var m=t(7929),x=t(5168),h=t(1146),u=t(3388),p=t(4230),f=t(1996),y=t(4413),g=t(4292),j=t(579);const v=()=>{const{seanceId:e}=(0,a.g)(),s=(0,a.Zp)(),{user:t}=(0,g.A)(),[v,b]=(0,r.useState)(null),[w,N]=(0,r.useState)([]),[A,k]=(0,r.useState)(null),[C,E]=(0,r.useState)(!0),[S,$]=(0,r.useState)(!1),[V,U]=(0,r.useState)({}),[q,z]=(0,r.useState)({});(0,r.useEffect)(()=>{(async()=>{if(e)try{E(!0);const[s,a,l]=await Promise.all([(0,m.Si)(e),(0,h.Vm)(),(0,x.MS)(e)]);if(b(s),N(a),k(l),s&&t){const e={};for(const a of s.films)try{const s=await(0,x.X7)(a,t.uid);s&&(e[a]=s.note,U(e=>({...e,[a]:{filmId:a,note:s.note,...s.commentaire&&{commentaire:s.commentaire}}})))}catch(r){console.error(`Erreur lors du chargement du vote pour le film ${a}:`,r)}z(e)}}catch(r){l.Ay.error("Erreur lors du chargement de la s\xe9ance"),s(y.bw.VOTE)}finally{E(!1)}})()},[e,s]);if(C)return(0,j.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,j.jsx)("p",{className:"mt-4 text-gray-600",children:"Chargement de la s\xe9ance..."})]})});if(!v)return(0,j.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"S\xe9ance non trouv\xe9e"}),(0,j.jsx)(u.$,{onClick:()=>s(y.bw.VOTE),children:"Retour au vote"})]})});const D=w.filter(e=>v.films.includes(e.id));return(0,j.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,j.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,j.jsxs)("div",{className:"mb-8",children:[(0,j.jsx)(u.$,{variant:"ghost",icon:(0,j.jsx)(i.A,{className:"h-4 w-4"}),onClick:()=>s(y.bw.VOTE),className:"mb-4",children:"Retour"}),(0,j.jsx)(p.Z,{className:"mb-6",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:v.nom}),(0,j.jsxs)("div",{className:"flex items-center justify-center space-x-6 text-gray-600",children:[(0,j.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,j.jsx)(n.A,{className:"h-4 w-4"}),(0,j.jsxs)("span",{children:[v.date.toLocaleDateString("fr-FR")," \xe0 ",v.heure]})]}),(0,j.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,j.jsx)(o.A,{className:"h-4 w-4"}),(0,j.jsxs)("span",{children:[D.length," film",D.length>1?"s":""]})]})]}),v.description&&(0,j.jsx)("p",{className:"mt-4 text-gray-600",children:v.description})]})})]}),(0,j.jsx)(p.Z,{className:"mb-8",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Votez pour les films de cette s\xe9ance"}),(0,j.jsx)("p",{className:"text-gray-600 mb-4",children:"Notez chaque film de 1 \xe0 5 \xe9toiles et ajoutez un commentaire optionnel. Vous ne pouvez voter qu'une seule fois par film."}),(0,j.jsxs)("div",{className:"flex items-center justify-center space-x-8 text-sm text-gray-500",children:[(0,j.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,j.jsx)(c.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,j.jsx)("span",{children:"1 = Tr\xe8s mauvais"})]}),(0,j.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,j.jsx)(c.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,j.jsx)(c.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,j.jsx)(c.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,j.jsx)(c.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,j.jsx)(c.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,j.jsx)("span",{children:"5 = Excellent"})]})]})]})}),(0,j.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:D.map(e=>{var s;const t=null===A||void 0===A||null===(s=A.films)||void 0===s?void 0:s.find(s=>s.filmId===e.id),r=q[e.id],a=!!r;return(0,j.jsx)(f.b,{id:e.id,title:e.titre,director:e.realisateur,duration:e.duree,year:e.annee,country:e.pays,synopsis:e.synopsis,rating:(null===t||void 0===t?void 0:t.moyenneNote)||0,voteCount:(null===t||void 0===t?void 0:t.totalVotes)||0,userVote:r,hasVoted:a,onVote:s=>((e,s,t)=>{U(r=>({...r,[e]:void 0!==t?{filmId:e,note:s,commentaire:t}:{filmId:e,note:s}}))})(e.id,s),className:"h-full",...e.posterUrl&&{posterUrl:e.posterUrl}},e.id)})}),(0,j.jsx)("div",{className:"mt-8 text-center",children:(0,j.jsx)(u.$,{onClick:async()=>{if(v&&0!==Object.keys(V).length)try{$(!0);const e=Object.values(V).map(e=>(0,x._M)({filmId:e.filmId,seanceId:v.id,note:e.note,...(null===t||void 0===t?void 0:t.uid)&&{userId:t.uid},...void 0!==e.commentaire?{commentaire:e.commentaire}:{}}));await Promise.all(e),l.Ay.success("Votes enregistr\xe9s avec succ\xe8s !"),s(y.bw.RESULTS)}catch(e){l.Ay.error("Erreur lors de l'enregistrement des votes")}finally{$(!1)}else l.Ay.error("Veuillez voter pour au moins un film")},loading:S,disabled:0===Object.keys(V).length,icon:(0,j.jsx)(d,{className:"h-4 w-4"}),size:"lg",children:S?"Envoi en cours...":`Envoyer ${Object.keys(V).length} vote${Object.keys(V).length>1?"s":""}`})})]})})}},3388:(e,s,t)=>{t.d(s,{$:()=>l});t(5043);var r=t(6925),a=t(579);const l=e=>{let{variant:s="primary",size:t="md",loading:l=!1,icon:i,children:n,className:o,disabled:c,...d}=e;return(0,a.jsxs)("button",{className:(0,r.cn)("inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-primary text-white hover:bg-primary-dark focus:ring-primary border-2 border-primary",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border-2 border-primary bg-white text-primary hover:bg-primary hover:text-white focus:ring-primary",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[s],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[t],o),disabled:c||l,...d,children:[l&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!l&&i&&(0,a.jsx)("span",{className:"mr-2",children:i}),n]})}},4230:(e,s,t)=>{t.d(s,{Z:()=>l});t(5043);var r=t(6925),a=t(579);const l=e=>{let{children:s,className:t,padding:l="md",shadow:i="md"}=e;return(0,a.jsx)("div",{className:(0,r.cn)("bg-white rounded-lg border border-gray-200",{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[l],{none:"",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg"}[i],t),children:s})}},5469:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(1639).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7929:(e,s,t)=>{t.d(s,{L6:()=>m,Si:()=>d,We:()=>h,Xb:()=>x,gc:()=>o,q5:()=>c});var r=t(4455),a=t(5472),l=t(6925);const i="seances",n="films",o=async e=>{try{if(5!==e.films.length)throw new Error("Une s\xe9ance doit contenir exactement 5 films");const s=e.films.map(e=>(0,a.x7)((0,a.H9)(r.db,n,e))),t=(await Promise.all(s)).map((s,t)=>({snapshot:s,filmId:e.films[t]})).filter(e=>{let{snapshot:s}=e;return!s.exists()});if(t.length>0)throw new Error(`Films non trouv\xe9s: ${t.map(e=>e.filmId).join(", ")}`);const o=(0,l.$C)(),c=u(o),d={nom:e.nom,date:e.date,heure:e.heure,films:e.films,qrCodeUrl:c,isActive:!0,createdAt:new Date,updatedAt:new Date,...e.description&&{description:e.description}};return{id:(await(0,a.gS)((0,a.rJ)(r.db,i),d)).id,...d}}catch(s){throw console.error("Erreur lors de la cr\xe9ation de la s\xe9ance:",s),s}},c=async()=>{try{const e=(0,a.P)((0,a.rJ)(r.db,i),(0,a.My)("date","desc")),s=await(0,a.GG)(e),t=[];return s.forEach(e=>{const s=e.data();t.push({id:e.id,nom:s.nom,description:s.description,date:s.date.toDate(),heure:s.heure,films:s.films,qrCodeUrl:s.qrCodeUrl,isActive:s.isActive,createdAt:s.createdAt.toDate(),updatedAt:s.updatedAt.toDate()})}),t}catch(e){throw console.error("Erreur lors de la r\xe9cup\xe9ration des s\xe9ances:",e),e}},d=async e=>{try{const s=(0,a.H9)(r.db,i,e),t=await(0,a.x7)(s);if(t.exists()){const e=t.data();return{id:t.id,nom:e.nom,description:e.description,date:e.date.toDate(),heure:e.heure,films:e.films,qrCodeUrl:e.qrCodeUrl,isActive:e.isActive,createdAt:e.createdAt.toDate(),updatedAt:e.updatedAt.toDate()}}return null}catch(s){throw console.error("Erreur lors de la r\xe9cup\xe9ration de la s\xe9ance:",s),s}},m=async(e,s)=>{try{const t=(0,a.H9)(r.db,i,e),l={...s,updatedAt:new Date};if(s.films&&5!==s.films.length)throw new Error("Une s\xe9ance doit contenir exactement 5 films");await(0,a.mZ)(t,l)}catch(t){throw console.error("Erreur lors de la mise \xe0 jour de la s\xe9ance:",t),t}},x=async e=>{try{const s=(0,a.H9)(r.db,i,e);await(0,a.kd)(s)}catch(s){throw console.error("Erreur lors de la suppression de la s\xe9ance:",s),s}},h=async(e,s)=>{try{const t=(0,a.H9)(r.db,i,e);await(0,a.mZ)(t,{isActive:s,updatedAt:new Date})}catch(t){throw console.error("Erreur lors de la modification du statut de la s\xe9ance:",t),t}},u=e=>{const s=window.location.origin;return`https://api.qrserver.com/v1/create-qr-code/?${new URLSearchParams({size:"300x300",data:`${s}/seance/${e}`,format:"png"}).toString()}`}}}]);
//# sourceMappingURL=3.0aaf4694.chunk.js.map