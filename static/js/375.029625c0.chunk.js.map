{"version":3,"file":"static/js/375.029625c0.chunk.js","mappings":"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","sources":["services/filmService.ts","../node_modules/lucide-react/src/icons/clock.ts","services/voteService.ts","utils/helpers.ts","../node_modules/lucide-react/src/icons/message-square.ts","../node_modules/lucide-react/src/icons/check-circle.ts","pages/VotePage.tsx"],"sourcesContent":["import { db, storage } from './firebase';\nimport { \n  collection, \n  doc, \n  addDoc, \n  updateDoc, \n  deleteDoc, \n  getDocs, \n  getDoc, \n  query, \n  where, \n  orderBy,\n  limit\n} from 'firebase/firestore';\nimport { ref, uploadBytes, getDownloadURL, deleteObject } from 'firebase/storage';\nimport { Film, CreateFilmData } from '../types';\nimport { generateId } from '../utils/helpers';\n\nconst FILMS_COLLECTION = 'films';\nconst POSTERS_FOLDER = 'posters';\n\n/**\n * Cr√©er un nouveau film avec upload du poster\n */\nexport const createFilm = async (data: CreateFilmData): Promise<Film> => {\n  try {\n    let posterUrl: string | undefined;\n\n    // Upload du poster si fourni\n    if (data.poster) {\n      posterUrl = await uploadPoster(data.poster);\n    }\n\n    const filmData: Omit<Film, 'id'> = {\n      titre: data.titre,\n      realisateur: data.realisateur,\n      pays: data.pays,\n      duree: data.duree,\n      annee: data.annee,\n      synopsis: data.synopsis,\n      posterUrl,\n      genre: data.genre,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    const docRef = await addDoc(collection(db, FILMS_COLLECTION), filmData);\n    \n    return {\n      id: docRef.id,\n      ...filmData,\n    };\n  } catch (error) {\n    console.error('Erreur lors de la cr√©ation du film:', error);\n    throw error;\n  }\n};\n\n/**\n * R√©cup√©rer tous les films\n */\nexport const getAllFilms = async (): Promise<Film[]> => {\n  try {\n    const q = query(\n      collection(db, FILMS_COLLECTION),\n      orderBy('titre', 'asc')\n    );\n    \n    const querySnapshot = await getDocs(q);\n    const films: Film[] = [];\n    \n    querySnapshot.forEach((doc) => {\n      const data = doc.data();\n      films.push({\n        id: doc.id,\n        titre: data.titre,\n        realisateur: data.realisateur,\n        pays: data.pays,\n        duree: data.duree,\n        annee: data.annee,\n        synopsis: data.synopsis,\n        posterUrl: data.posterUrl,\n        genre: data.genre,\n        createdAt: data.createdAt.toDate(),\n        updatedAt: data.updatedAt.toDate(),\n      });\n    });\n    \n    return films;\n  } catch (error) {\n    console.error('Erreur lors de la r√©cup√©ration des films:', error);\n    throw error;\n  }\n};\n\n/**\n * R√©cup√©rer un film par son ID\n */\nexport const getFilmById = async (filmId: string): Promise<Film | null> => {\n  try {\n    const docRef = doc(db, FILMS_COLLECTION, filmId);\n    const docSnap = await getDoc(docRef);\n    \n    if (docSnap.exists()) {\n      const data = docSnap.data();\n      return {\n        id: docSnap.id,\n        titre: data.titre,\n        realisateur: data.realisateur,\n        pays: data.pays,\n        duree: data.duree,\n        annee: data.annee,\n        synopsis: data.synopsis,\n        posterUrl: data.posterUrl,\n        genre: data.genre,\n        createdAt: data.createdAt.toDate(),\n        updatedAt: data.updatedAt.toDate(),\n      };\n    }\n    \n    return null;\n  } catch (error) {\n    console.error('Erreur lors de la r√©cup√©ration du film:', error);\n    throw error;\n  }\n};\n\n/**\n * Mettre √† jour un film\n */\nexport const updateFilm = async (filmId: string, data: Partial<CreateFilmData>): Promise<void> => {\n  try {\n    const docRef = doc(db, FILMS_COLLECTION, filmId);\n    \n    const updateData: any = {\n      ...data,\n      updatedAt: new Date(),\n    };\n\n    // Upload du nouveau poster si fourni\n    if (data.poster) {\n      updateData.posterUrl = await uploadPoster(data.poster);\n    }\n\n    await updateDoc(docRef, updateData);\n  } catch (error) {\n    console.error('Erreur lors de la mise √† jour du film:', error);\n    throw error;\n  }\n};\n\n/**\n * Supprimer un film\n */\nexport const deleteFilm = async (filmId: string): Promise<void> => {\n  try {\n    // R√©cup√©rer le film pour supprimer le poster\n    const film = await getFilmById(filmId);\n    if (film?.posterUrl) {\n      await deletePoster(film.posterUrl);\n    }\n\n    const docRef = doc(db, FILMS_COLLECTION, filmId);\n    await deleteDoc(docRef);\n  } catch (error) {\n    console.error('Erreur lors de la suppression du film:', error);\n    throw error;\n  }\n};\n\n/**\n * Upload d'un poster\n */\nexport const uploadPoster = async (file: File): Promise<string> => {\n  try {\n    const fileName = `${generateId()}_${file.name}`;\n    const storageRef = ref(storage, `${POSTERS_FOLDER}/${fileName}`);\n    \n    const snapshot = await uploadBytes(storageRef, file);\n    const downloadURL = await getDownloadURL(snapshot.ref);\n    \n    return downloadURL;\n  } catch (error) {\n    console.error('Erreur lors de l\\'upload du poster:', error);\n    throw error;\n  }\n};\n\n/**\n * Supprimer un poster\n */\nexport const deletePoster = async (posterUrl: string): Promise<void> => {\n  try {\n    const storageRef = ref(storage, posterUrl);\n    await deleteObject(storageRef);\n  } catch (error) {\n    console.error('Erreur lors de la suppression du poster:', error);\n    // Ne pas throw l'erreur car ce n'est pas critique\n  }\n};\n\n/**\n * Rechercher des films\n */\nexport const searchFilms = async (searchTerm: string): Promise<Film[]> => {\n  try {\n    const films = await getAllFilms();\n    const term = searchTerm.toLowerCase();\n    \n    return films.filter(film => \n      film.titre.toLowerCase().includes(term) ||\n      film.realisateur.toLowerCase().includes(term) ||\n      film.pays.toLowerCase().includes(term) ||\n      film.genre.toLowerCase().includes(term)\n    );\n  } catch (error) {\n    console.error('Erreur lors de la recherche de films:', error);\n    throw error;\n  }\n};\n\n/**\n * R√©cup√©rer les films par genre\n */\nexport const getFilmsByGenre = async (genre: string): Promise<Film[]> => {\n  try {\n    const q = query(\n      collection(db, FILMS_COLLECTION),\n      where('genre', '==', genre),\n      orderBy('titre', 'asc')\n    );\n    \n    const querySnapshot = await getDocs(q);\n    const films: Film[] = [];\n    \n    querySnapshot.forEach((doc) => {\n      const data = doc.data();\n      films.push({\n        id: doc.id,\n        titre: data.titre,\n        realisateur: data.realisateur,\n        pays: data.pays,\n        duree: data.duree,\n        annee: data.annee,\n        synopsis: data.synopsis,\n        posterUrl: data.posterUrl,\n        genre: data.genre,\n        createdAt: data.createdAt.toDate(),\n        updatedAt: data.updatedAt.toDate(),\n      });\n    });\n    \n    return films;\n  } catch (error) {\n    console.error('Erreur lors de la r√©cup√©ration des films par genre:', error);\n    throw error;\n  }\n};\n\n/**\n * R√©cup√©rer les films r√©cents\n */\nexport const getRecentFilms = async (limitCount: number = 10): Promise<Film[]> => {\n  try {\n    const q = query(\n      collection(db, FILMS_COLLECTION),\n      orderBy('createdAt', 'desc'),\n      limit(limitCount)\n    );\n    \n    const querySnapshot = await getDocs(q);\n    const films: Film[] = [];\n    \n    querySnapshot.forEach((doc) => {\n      const data = doc.data();\n      films.push({\n        id: doc.id,\n        titre: data.titre,\n        realisateur: data.realisateur,\n        pays: data.pays,\n        duree: data.duree,\n        annee: data.annee,\n        synopsis: data.synopsis,\n        posterUrl: data.posterUrl,\n        genre: data.genre,\n        createdAt: data.createdAt.toDate(),\n        updatedAt: data.updatedAt.toDate(),\n      });\n    });\n    \n    return films;\n  } catch (error) {\n    console.error('Erreur lors de la r√©cup√©ration des films r√©cents:', error);\n    throw error;\n  }\n};\n\n/**\n * R√©cup√©rer les statistiques des films\n */\nexport const getFilmsStats = async (): Promise<{\n  total: number;\n  parGenre: Record<string, number>;\n  parPays: Record<string, number>;\n  parAnnee: Record<number, number>;\n}> => {\n  try {\n    const films = await getAllFilms();\n    \n    const stats = {\n      total: films.length,\n      parGenre: {} as Record<string, number>,\n      parPays: {} as Record<string, number>,\n      parAnnee: {} as Record<number, number>,\n    };\n    \n    films.forEach(film => {\n      // Compter par genre\n      stats.parGenre[film.genre] = (stats.parGenre[film.genre] || 0) + 1;\n      \n      // Compter par pays\n      stats.parPays[film.pays] = (stats.parPays[film.pays] || 0) + 1;\n      \n      // Compter par ann√©e\n      stats.parAnnee[film.annee] = (stats.parAnnee[film.annee] || 0) + 1;\n    });\n    \n    return stats;\n  } catch (error) {\n    console.error('Erreur lors de la r√©cup√©ration des statistiques des films:', error);\n    throw error;\n  }\n};\n\n/**\n * R√©cup√©rer les genres disponibles\n */\nexport const getAvailableGenres = async (): Promise<string[]> => {\n  try {\n    const films = await getAllFilms();\n    const genres = Array.from(new Set(films.map(film => film.genre)));\n    return genres.sort();\n  } catch (error) {\n    console.error('Erreur lors de la r√©cup√©ration des genres:', error);\n    throw error;\n  }\n};\n\n/**\n * R√©cup√©rer les pays disponibles\n */\nexport const getAvailableCountries = async (): Promise<string[]> => {\n  try {\n    const films = await getAllFilms();\n    const countries = Array.from(new Set(films.map(film => film.pays)));\n    return countries.sort();\n  } catch (error) {\n    console.error('Erreur lors de la r√©cup√©ration des pays:', error);\n    throw error;\n  }\n}; ","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Clock\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxMiA2IDEyIDEyIDE2IDE0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/clock\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Clock = createLucideIcon('Clock', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['polyline', { points: '12 6 12 12 16 14', key: '68esgv' }],\n]);\n\nexport default Clock;\n","import {\n  collection,\n  doc,\n  deleteDoc,\n  getDocs,\n  query,\n  where,\n  orderBy,\n  onSnapshot,\n  writeBatch,\n  setDoc,\n} from 'firebase/firestore';\nimport { db } from './firebase';\nimport { Vote, VoteFormData } from '../types';\nimport { COLLECTIONS } from '../utils/constants';\nimport { generateId, generateSessionId, getUserAgent, getIpAddress } from '../utils/helpers';\n\n// Queue pour les votes en batch\nlet voteQueue: Vote[] = [];\nlet batchTimeout: number | null = null;\nlet isProcessingBatch = false;\n\n/**\n * Ajouter un vote directement (pour les s√©ances)\n */\nexport const addVote = async (data: {\n  filmId: string;\n  seanceId?: string;\n  note: number;\n  commentaire?: string;\n}): Promise<void> => {\n  try {\n    const vote: Vote = {\n      id: generateId(),\n      filmId: data.filmId,\n      seanceId: data.seanceId || '',\n      note: data.note,\n      commentaire: data.commentaire?.trim(),\n      ipAddress: await getIpAddress() || undefined,\n      userAgent: getUserAgent(),\n      sessionId: generateSessionId(),\n      createdAt: new Date(),\n    };\n\n    // Ajouter directement √† Firestore\n    const voteRef = doc(collection(db, COLLECTIONS.VOTES));\n    await setDoc(voteRef, {\n      ...vote,\n      id: voteRef.id,\n    } as any);\n  } catch (error: any) {\n    throw new Error('Erreur lors de l\\'ajout du vote');\n  }\n};\n\n/**\n * Ajouter un vote √† la queue\n */\nexport const addVoteToQueue = async (\n  filmId: string,\n  data: VoteFormData,\n  user?: { uid: string; email: string } | null,\n  sessionId?: string\n): Promise<void> => {\n  try {\n    const vote: Vote = {\n      id: generateId(),\n      filmId,\n      seanceId: '',\n      note: data.note,\n      commentaire: data.commentaire?.trim(),\n      ipAddress: await getIpAddress() || undefined,\n      userAgent: getUserAgent(),\n      sessionId: sessionId || generateSessionId(),\n      createdAt: new Date(),\n    };\n\n    voteQueue.push(vote);\n\n    // D√©marrer le timer pour l'envoi en batch\n    if (!batchTimeout) {\n      batchTimeout = window.setTimeout(() => {\n        processVoteBatch();\n      }, 5000); // 5 secondes de d√©lai\n    }\n\n    // V√©rifier si l'utilisateur a d√©j√† vot√© pour ce film\n    const hasVoted = await checkIfUserVoted(filmId, user?.uid, sessionId);\n    if (hasVoted) {\n      throw new Error('Vous avez d√©j√† vot√© pour ce film');\n    }\n  } catch (error: any) {\n    throw new Error(error.message || 'Erreur lors de l\\'ajout du vote');\n  }\n};\n\n/**\n * Traiter la queue de votes en batch\n */\nconst processVoteBatch = async (): Promise<void> => {\n  if (isProcessingBatch || voteQueue.length === 0) {\n    return;\n  }\n\n  isProcessingBatch = true;\n  const votesToProcess = [...voteQueue];\n  voteQueue = [];\n  batchTimeout = null;\n\n  try {\n    const batch = writeBatch(db);\n\n    // Ajouter tous les votes au batch\n    votesToProcess.forEach((vote) => {\n      const voteRef = doc(collection(db, COLLECTIONS.VOTES));\n      batch.set(voteRef, {\n        ...vote,\n        id: voteRef.id,\n      });\n    });\n\n    // Ex√©cuter le batch\n    await batch.commit();\n\n    console.log(`${votesToProcess.length} votes envoy√©s avec succ√®s`);\n  } catch (error) {\n    console.error('Erreur lors de l\\'envoi du batch:', error);\n    \n    // Remettre les votes dans la queue pour retry\n    voteQueue.unshift(...votesToProcess);\n    \n    // Retry apr√®s 10 secondes\n    setTimeout(() => {\n      isProcessingBatch = false;\n      if (voteQueue.length > 0) {\n        processVoteBatch();\n      }\n    }, 10000);\n  } finally {\n    isProcessingBatch = false;\n  }\n};\n\n/**\n * V√©rifier si un utilisateur a d√©j√† vot√© pour un film\n */\nexport const checkIfUserVoted = async (\n  filmId: string,\n  userId?: string,\n  sessionId?: string\n): Promise<boolean> => {\n  try {\n    let voteQuery;\n\n    if (userId) {\n      // Utilisateur connect√©\n      voteQuery = query(\n        collection(db, COLLECTIONS.VOTES),\n        where('filmId', '==', filmId),\n        where('userId', '==', userId)\n      );\n    } else if (sessionId) {\n      // Vote anonyme\n      voteQuery = query(\n        collection(db, COLLECTIONS.VOTES),\n        where('filmId', '==', filmId),\n        where('sessionId', '==', sessionId)\n      );\n    } else {\n      return false;\n    }\n\n    const querySnapshot = await getDocs(voteQuery);\n    return !querySnapshot.empty;\n  } catch (error) {\n    console.error('Erreur lors de la v√©rification du vote:', error);\n    return false;\n  }\n};\n\n/**\n * R√©cup√©rer les votes d'un film\n */\nexport const getFilmVotes = async (filmId: string): Promise<Vote[]> => {\n  try {\n    const votesQuery = query(\n      collection(db, COLLECTIONS.VOTES),\n      where('filmId', '==', filmId),\n      orderBy('createdAt', 'desc')\n    );\n\n    const querySnapshot = await getDocs(votesQuery);\n    const votes: Vote[] = [];\n\n    querySnapshot.forEach((doc) => {\n      const voteData = doc.data();\n      votes.push({\n        ...voteData,\n        id: doc.id,\n        createdAt: voteData.createdAt?.toDate() || new Date(),\n      } as Vote);\n    });\n\n    return votes;\n  } catch (error: any) {\n    throw new Error('Erreur lors de la r√©cup√©ration des votes');\n  }\n};\n\n/**\n * Supprimer un vote\n */\nexport const deleteVote = async (voteId: string): Promise<void> => {\n  try {\n    await deleteDoc(doc(db, COLLECTIONS.VOTES, voteId));\n  } catch (error: any) {\n    throw new Error('Erreur lors de la suppression du vote');\n  }\n};\n\n/**\n * R√©cup√©rer les statistiques d'un film\n */\nexport const getFilmStats = async (filmId: string): Promise<{\n  filmId: string;\n  titre: string;\n  totalVotes: number;\n  moyenneNote: number;\n  distributionNotes: Record<number, number>;\n  commentaires: string[];\n}> => {\n  try {\n    const votes = await getFilmVotes(filmId);\n    const ratings = votes.map(vote => vote.note);\n    \n    const distribution: Record<number, number> = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };\n    ratings.forEach(rating => {\n      if (rating >= 1 && rating <= 5) {\n        distribution[rating]++;\n      }\n    });\n\n    const moyenne = ratings.length > 0 \n      ? Math.round((ratings.reduce((sum, r) => sum + r, 0) / ratings.length) * 10) / 10\n      : 0;\n\n    const commentaires = votes\n      .filter(vote => vote.commentaire)\n      .map(vote => vote.commentaire!)\n      .slice(0, 10); // Limiter √† 10 commentaires\n\n    return {\n      filmId,\n      titre: '', // Sera rempli par l'appelant\n      totalVotes: votes.length,\n      moyenneNote: moyenne,\n      distributionNotes: distribution,\n      commentaires,\n    };\n  } catch (error: any) {\n    throw new Error('Erreur lors du calcul des statistiques');\n  }\n};\n\n/**\n * √âcouter les changements de votes pour un film\n */\nexport const onVotesChange = (filmId: string, callback: (votes: Vote[]) => void) => {\n  const votesQuery = query(\n    collection(db, COLLECTIONS.VOTES),\n    where('filmId', '==', filmId),\n    orderBy('createdAt', 'desc')\n  );\n\n  return onSnapshot(votesQuery, (querySnapshot) => {\n    const votes: Vote[] = [];\n\n    querySnapshot.forEach((doc) => {\n      const voteData = doc.data();\n      votes.push({\n        ...voteData,\n        id: doc.id,\n        createdAt: voteData.createdAt?.toDate() || new Date(),\n      } as Vote);\n    });\n\n    callback(votes);\n  });\n};\n\n/**\n * R√©cup√©rer le statut de la queue de votes\n */\nexport const getVoteQueueStatus = () => {\n  return {\n    pendingVotes: voteQueue.length,\n    isProcessing: isProcessingBatch,\n    nextBatchIn: batchTimeout ? 5000 : 0,\n  };\n};\n\n/**\n * Forcer l'envoi imm√©diat de la queue\n */\nexport const forceProcessBatch = async (): Promise<void> => {\n  if (batchTimeout) {\n    clearTimeout(batchTimeout);\n    batchTimeout = null;\n  }\n  await processVoteBatch();\n};\n\n/**\n * R√©cup√©rer les r√©sultats d'une s√©ance\n */\nexport const getSeanceResults = async (seanceId: string): Promise<{\n  seanceId: string;\n  totalVotes: number;\n  films: Array<{\n    filmId: string;\n    titre: string;\n    totalVotes: number;\n    moyenneNote: number;\n    distributionNotes: Record<number, number>;\n  }>;\n}> => {\n  try {\n    // R√©cup√©rer tous les votes de la s√©ance\n    const votesQuery = query(\n      collection(db, COLLECTIONS.VOTES),\n      where('seanceId', '==', seanceId),\n      orderBy('createdAt', 'desc')\n    );\n\n    const querySnapshot = await getDocs(votesQuery);\n    const votes: Vote[] = [];\n\n    querySnapshot.forEach((doc) => {\n      const voteData = doc.data();\n      votes.push({\n        ...voteData,\n        id: doc.id,\n        createdAt: voteData.createdAt?.toDate() || new Date(),\n      } as Vote);\n    });\n\n    // Grouper les votes par film\n    const filmVotes: Record<string, Vote[]> = {};\n    votes.forEach(vote => {\n      if (!filmVotes[vote.filmId]) {\n        filmVotes[vote.filmId] = [];\n      }\n      filmVotes[vote.filmId].push(vote);\n    });\n\n    // Calculer les statistiques pour chaque film\n    const films = Object.entries(filmVotes).map(([filmId, filmVotes]) => {\n      const ratings = filmVotes.map(vote => vote.note);\n      const distribution: Record<number, number> = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };\n      \n      ratings.forEach(rating => {\n        if (rating >= 1 && rating <= 5) {\n          distribution[rating]++;\n        }\n      });\n\n      const moyenne = ratings.length > 0 \n        ? Math.round((ratings.reduce((sum, r) => sum + r, 0) / ratings.length) * 10) / 10\n        : 0;\n\n      return {\n        filmId,\n        titre: '', // Sera rempli par l'appelant\n        totalVotes: filmVotes.length,\n        moyenneNote: moyenne,\n        distributionNotes: distribution,\n      };\n    });\n\n    return {\n      seanceId,\n      totalVotes: votes.length,\n      films,\n    };\n  } catch (error: any) {\n    throw new Error('Erreur lors de la r√©cup√©ration des r√©sultats de la s√©ance');\n  }\n}; ","import { VALIDATION_RULES } from './constants';\r\n\r\n/**\r\n * G√©n√®re un ID unique\r\n */\r\nexport const generateId = (): string => {\r\n  return Date.now().toString(36) + Math.random().toString(36).substring(2);\r\n};\r\n\r\n/**\r\n * G√©n√®re un ID de session unique pour les votes anonymes\r\n */\r\nexport const generateSessionId = (): string => {\r\n  const timestamp = Date.now();\r\n  const random = Math.random().toString(36).substring(2);\r\n  return `${timestamp}-${random}`;\r\n};\r\n\r\n/**\r\n * Valide une adresse email\r\n */\r\nexport const isValidEmail = (email: string): boolean => {\r\n  return VALIDATION_RULES.EMAIL.test(email);\r\n};\r\n\r\n/**\r\n * Valide un mot de passe\r\n */\r\nexport const isValidPassword = (password: string): boolean => {\r\n  return password.length >= VALIDATION_RULES.PASSWORD_MIN_LENGTH;\r\n};\r\n\r\n/**\r\n * Valide un fichier image\r\n */\r\nexport const isValidImageFile = (file: File): boolean => {\r\n  return (\r\n    VALIDATION_RULES.ALLOWED_IMAGE_TYPES.indexOf(file.type) !== -1 &&\r\n    file.size <= VALIDATION_RULES.MAX_FILE_SIZE\r\n  );\r\n};\r\n\r\n/**\r\n * Redimensionne une image\r\n */\r\nexport const resizeImage = (\r\n  file: File,\r\n  maxWidth: number = 800,\r\n  maxHeight: number = 600,\r\n  quality: number = 0.8\r\n): Promise<Blob> => {\r\n  return new Promise((resolve, reject) => {\r\n    const canvas = document.createElement('canvas');\r\n    const ctx = canvas.getContext('2d');\r\n    const img = new Image();\r\n\r\n    img.onload = () => {\r\n      // Calculer les nouvelles dimensions\r\n      let { width, height } = img;\r\n      \r\n      if (width > maxWidth) {\r\n        height = (height * maxWidth) / width;\r\n        width = maxWidth;\r\n      }\r\n      \r\n      if (height > maxHeight) {\r\n        width = (width * maxHeight) / height;\r\n        height = maxHeight;\r\n      }\r\n\r\n      canvas.width = width;\r\n      canvas.height = height;\r\n\r\n      if (ctx) {\r\n        ctx.drawImage(img, 0, 0, width, height);\r\n        canvas.toBlob(\r\n          (blob) => {\r\n            if (blob) {\r\n              resolve(blob);\r\n            } else {\r\n              reject(new Error('Erreur lors du redimensionnement'));\r\n            }\r\n          },\r\n          'image/jpeg',\r\n          quality\r\n        );\r\n      } else {\r\n        reject(new Error('Impossible de cr√©er le contexte canvas'));\r\n      }\r\n    };\r\n\r\n    img.onerror = () => reject(new Error('Erreur lors du chargement de l\\'image'));\r\n    img.src = URL.createObjectURL(file);\r\n  });\r\n};\r\n\r\n/**\r\n * Formate une date\r\n */\r\nexport const formatDate = (date: Date): string => {\r\n  return new Intl.DateTimeFormat('fr-FR', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n  }).format(date);\r\n};\r\n\r\n/**\r\n * Formate une note avec √©toiles\r\n */\r\nexport const formatRating = (rating: number): string => {\r\n  return `${rating}/5`;\r\n};\r\n\r\n/**\r\n * Calcule la moyenne des notes\r\n */\r\nexport const calculateAverageRating = (ratings: number[]): number => {\r\n  if (ratings.length === 0) return 0;\r\n  const sum = ratings.reduce((acc, rating) => acc + rating, 0);\r\n  return Math.round((sum / ratings.length) * 10) / 10;\r\n};\r\n\r\n/**\r\n * G√©n√®re une distribution des notes\r\n */\r\nexport const generateRatingDistribution = (ratings: number[]): Record<number, number> => {\r\n  const distribution: Record<number, number> = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };\r\n  \r\n  ratings.forEach(rating => {\r\n    if (rating >= 1 && rating <= 5) {\r\n      distribution[rating]++;\r\n    }\r\n  });\r\n  \r\n  return distribution;\r\n};\r\n\r\n/**\r\n * Retourne l'User Agent du navigateur\r\n */\r\nexport const getUserAgent = (): string => {\r\n  return navigator.userAgent;\r\n};\r\n\r\n/**\r\n * Retourne l'adresse IP (approximative via service externe)\r\n */\r\nexport const getIpAddress = async (): Promise<string | null> => {\r\n  try {\r\n    const response = await fetch('https://api.ipify.org?format=json');\r\n    const data = await response.json();\r\n    return data.ip;\r\n  } catch (error) {\r\n    console.warn('Impossible de r√©cup√©rer l\\'IP:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Stocke une valeur dans le localStorage\r\n */\r\nexport const setLocalStorage = (key: string, value: any): void => {\r\n  try {\r\n    localStorage.setItem(key, JSON.stringify(value));\r\n  } catch (error) {\r\n    console.warn('Erreur lors du stockage local:', error);\r\n  }\r\n};\r\n\r\n/**\r\n * R√©cup√®re une valeur du localStorage\r\n */\r\nexport const getLocalStorage = <T>(key: string, defaultValue: T): T => {\r\n  try {\r\n    const item = localStorage.getItem(key);\r\n    return item ? JSON.parse(item) : defaultValue;\r\n  } catch (error) {\r\n    console.warn('Erreur lors de la r√©cup√©ration locale:', error);\r\n    return defaultValue;\r\n  }\r\n};\r\n\r\n/**\r\n * Supprime une valeur du localStorage\r\n */\r\nexport const removeLocalStorage = (key: string): void => {\r\n  try {\r\n    localStorage.removeItem(key);\r\n  } catch (error) {\r\n    console.warn('Erreur lors de la suppression locale:', error);\r\n  }\r\n};\r\n\r\n/**\r\n * D√©bounce une fonction\r\n */\r\nexport const debounce = <T extends (...args: any[]) => any>(\r\n  func: T,\r\n  wait: number\r\n): ((...args: Parameters<T>) => void) => {\r\n  let timeout: number;\r\n  \r\n  return (...args: Parameters<T>) => {\r\n    clearTimeout(timeout);\r\n    timeout = window.setTimeout(() => func(...args), wait);\r\n  };\r\n};\r\n\r\n/**\r\n * Retry une fonction avec d√©lai\r\n */\r\nexport const retry = async <T>(\r\n  fn: () => Promise<T>,\r\n  maxRetries: number = 3,\r\n  delay: number = 1000\r\n): Promise<T> => {\r\n  let lastError: Error = new Error('Une erreur est survenue');\r\n  \r\n  for (let i = 0; i < maxRetries; i++) {\r\n    try {\r\n      return await fn();\r\n    } catch (error) {\r\n      lastError = error as Error;\r\n      if (i < maxRetries - 1) {\r\n        await new Promise(resolve => setTimeout(resolve, delay * Math.pow(2, i)));\r\n      }\r\n    }\r\n  }\r\n  \r\n  throw new Error(lastError.message || 'Une erreur est survenue');\r\n};\r\n\r\n/**\r\n * Combine les classes CSS\r\n */\r\nexport const cn = (...classes: (string | undefined | null | false)[]): string => {\r\n  return classes.filter(Boolean).join(' ');\r\n}; ","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name MessageSquare\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTVhMiAyIDAgMCAxLTIgMkg3bC00IDRWNWEyIDIgMCAwIDEgMi0yaDE0YTIgMiAwIDAgMSAyIDJ6IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/message-square\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst MessageSquare = createLucideIcon('MessageSquare', [\n  [\n    'path',\n    {\n      d: 'M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z',\n      key: '1lielz',\n    },\n  ],\n]);\n\nexport default MessageSquare;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name CheckCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjIgMTEuMDhWMTJhMTAgMTAgMCAxIDEtNS45My05LjE0IiAvPgogIDxwb2x5bGluZSBwb2ludHM9IjIyIDQgMTIgMTQuMDEgOSAxMS4wMSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/check-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CheckCircle = createLucideIcon('CheckCircle', [\n  ['path', { d: 'M22 11.08V12a10 10 0 1 1-5.93-9.14', key: 'g774vq' }],\n  ['polyline', { points: '22 4 12 14.01 9 11.01', key: '6xbx8j' }],\n]);\n\nexport default CheckCircle;\n","import React, { useState, useEffect } from 'react';\r\nimport { Star, MessageSquare, CheckCircle, Clock } from 'lucide-react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport { z } from 'zod';\r\nimport toast from 'react-hot-toast';\r\nimport { Film, VoteFormData } from '../types';\r\nimport { getAllFilms } from '../services/filmService';\r\nimport { addVoteToQueue, getVoteQueueStatus } from '../services/voteService';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { generateSessionId, getLocalStorage, setLocalStorage } from '../utils/helpers';\r\nimport { SUCCESS_MESSAGES, ERROR_MESSAGES } from '../utils/constants';\r\n\r\n// Sch√©ma de validation pour le vote\r\nconst voteSchema = z.object({\r\n  note: z.number().min(1).max(5),\r\n  commentaire: z.string().max(500).optional(),\r\n});\r\n\r\nexport const VotePage: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [films, setFilms] = useState<Film[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedFilm, setSelectedFilm] = useState<Film | null>(null);\r\n  const [queueStatus, setQueueStatus] = useState({ pendingVotes: 0, isProcessing: false, nextBatchIn: 0 });\r\n  const [sessionId] = useState(() => {\r\n    const existing = getLocalStorage('voteSessionId', '');\r\n    if (!existing) {\r\n      const newId = generateSessionId();\r\n      setLocalStorage('voteSessionId', newId);\r\n      return newId;\r\n    }\r\n    return existing;\r\n  });\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    setValue,\r\n    watch,\r\n    formState: { errors, isSubmitting },\r\n    reset,\r\n  } = useForm<VoteFormData>({\r\n    resolver: zodResolver(voteSchema),\r\n    defaultValues: {\r\n      note: 0,\r\n      commentaire: '',\r\n    },\r\n  });\r\n\r\n  const watchedNote = watch('note');\r\n\r\n  // Charger les films\r\n  useEffect(() => {\r\n    const loadFilms = async () => {\r\n      try {\r\n        const filmsData = await getAllFilms();\r\n        setFilms(filmsData);\r\n      } catch (error) {\r\n        toast.error(ERROR_MESSAGES.NETWORK_ERROR);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadFilms();\r\n  }, []);\r\n\r\n  // Surveiller le statut de la queue\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      const status = getVoteQueueStatus();\r\n      setQueueStatus(status);\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  // G√©rer la s√©lection d'une note\r\n  const handleRatingChange = (rating: number) => {\r\n    setValue('note', rating);\r\n  };\r\n\r\n  // Soumettre le vote\r\n  const onSubmit = async (data: VoteFormData) => {\r\n    if (!selectedFilm) {\r\n      toast.error('Veuillez s√©lectionner un film');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await addVoteToQueue(\r\n        selectedFilm.id,\r\n        data,\r\n        user ? { uid: user.uid, email: user.email } : null,\r\n        sessionId\r\n      );\r\n\r\n      toast.success(SUCCESS_MESSAGES.VOTE_PENDING);\r\n      reset();\r\n      setSelectedFilm(null);\r\n    } catch (error: any) {\r\n      toast.error(error.message || ERROR_MESSAGES.VOTE_ERROR);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Chargement des films...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <header className=\"bg-white shadow-sm\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex justify-between items-center py-6\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold text-primary-600\">Voter pour un film</h1>\r\n              <p className=\"text-secondary-600 mt-1\">\r\n                Donnez votre avis sur les films du festival\r\n              </p>\r\n            </div>\r\n            \r\n            {/* Statut de la queue */}\r\n            <div className=\"flex items-center space-x-4\">\r\n              {queueStatus.pendingVotes > 0 && (\r\n                <div className=\"flex items-center space-x-2 text-sm text-secondary-600\">\r\n                  <Clock className=\"w-4 h-4\" />\r\n                  <span>{queueStatus.pendingVotes} vote(s) en attente</span>\r\n                </div>\r\n              )}\r\n              {queueStatus.isProcessing && (\r\n                <div className=\"flex items-center space-x-2 text-sm text-primary-600\">\r\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-600\"></div>\r\n                  <span>Envoi en cours...</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        {films.length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"text-6xl mb-4\">üé¨</div>\r\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Aucun film disponible</h2>\r\n            <p className=\"text-gray-600\">Les films seront ajout√©s par l'administrateur.</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid lg:grid-cols-2 gap-8\">\r\n            {/* Liste des films */}\r\n            <div>\r\n              <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Films en comp√©tition</h2>\r\n              <div className=\"space-y-4\">\r\n                {films.map((film) => (\r\n                  <div\r\n                    key={film.id}\r\n                    className={`card cursor-pointer transition-all ${\r\n                      selectedFilm?.id === film.id\r\n                        ? 'ring-2 ring-primary-500 bg-primary-50'\r\n                        : 'hover:shadow-md'\r\n                    }`}\r\n                    onClick={() => setSelectedFilm(film)}\r\n                  >\r\n                    <div className=\"flex space-x-4\">\r\n                      {film.posterUrl && (\r\n                        <img\r\n                          src={film.posterUrl}\r\n                          alt={film.titre}\r\n                          className=\"w-16 h-24 object-cover rounded-lg\"\r\n                        />\r\n                      )}\r\n                      <div className=\"flex-1\">\r\n                        <h3 className=\"font-semibold text-gray-900\">{film.titre}</h3>\r\n                        <p className=\"text-sm text-gray-600 mb-2\">R√©alis√© par {film.realisateur}</p>\r\n                        <p className=\"text-sm text-gray-700 line-clamp-2\">{film.synopsis}</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Formulaire de vote */}\r\n            <div>\r\n              <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Votre vote</h2>\r\n              \r\n              {selectedFilm ? (\r\n                <div className=\"card\">\r\n                  <div className=\"mb-6\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n                      {selectedFilm.titre}\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-600 mb-4\">\r\n                      R√©alis√© par {selectedFilm.realisateur}\r\n                    </p>\r\n                    {selectedFilm.posterUrl && (\r\n                      <img\r\n                        src={selectedFilm.posterUrl}\r\n                        alt={selectedFilm.titre}\r\n                        className=\"w-full h-48 object-cover rounded-lg mb-4\"\r\n                      />\r\n                    )}\r\n                    <p className=\"text-gray-700\">{selectedFilm.synopsis}</p>\r\n                  </div>\r\n\r\n                  <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\r\n                    {/* Syst√®me de notation */}\r\n                    <div>\r\n                      <label className=\"form-label\">Votre note</label>\r\n                      <div className=\"star-rating\">\r\n                        {[1, 2, 3, 4, 5].map((star) => (\r\n                          <button\r\n                            key={star}\r\n                            type=\"button\"\r\n                            onClick={() => handleRatingChange(star)}\r\n                            className={`star ${\r\n                              star <= watchedNote ? 'star-filled' : 'star-empty'\r\n                            }`}\r\n                          >\r\n                            <Star className=\"w-8 h-8\" fill={star <= watchedNote ? 'currentColor' : 'none'} />\r\n                          </button>\r\n                        ))}\r\n                      </div>\r\n                      <p className=\"text-sm text-gray-600 mt-2\">\r\n                        {watchedNote > 0 ? `${watchedNote}/5 √©toiles` : 'Cliquez sur les √©toiles pour noter'}\r\n                      </p>\r\n                      {errors.note && (\r\n                        <p className=\"form-error\">{errors.note.message}</p>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Commentaire */}\r\n                    <div>\r\n                      <label className=\"form-label\">\r\n                        <MessageSquare className=\"w-4 h-4 inline mr-2\" />\r\n                        Commentaire (optionnel)\r\n                      </label>\r\n                      <textarea\r\n                        {...register('commentaire')}\r\n                        rows={4}\r\n                        className=\"input-field\"\r\n                        placeholder=\"Partagez votre avis sur ce film...\"\r\n                        maxLength={500}\r\n                      />\r\n                      {errors.commentaire && (\r\n                        <p className=\"form-error\">{errors.commentaire.message}</p>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Bouton de soumission */}\r\n                    <button\r\n                      type=\"submit\"\r\n                      disabled={isSubmitting || watchedNote === 0}\r\n                      className=\"btn-primary w-full disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    >\r\n                      {isSubmitting ? (\r\n                        <div className=\"flex items-center justify-center\">\r\n                          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                          Envoi en cours...\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center justify-center\">\r\n                          <CheckCircle className=\"w-4 h-4 mr-2\" />\r\n                          Envoyer mon vote\r\n                        </div>\r\n                      )}\r\n                    </button>\r\n                  </form>\r\n                </div>\r\n              ) : (\r\n                <div className=\"card text-center py-12\">\r\n                  <div className=\"text-6xl mb-4\">‚≠ê</div>\r\n                  <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n                    S√©lectionnez un film\r\n                  </h3>\r\n                  <p className=\"text-gray-600\">\r\n                    Cliquez sur un film dans la liste pour commencer √† voter\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}; "],"names":["FILMS_COLLECTION","getAllFilms","async","q","query","collection","db","orderBy","querySnapshot","getDocs","films","forEach","doc","data","push","id","titre","realisateur","pays","duree","annee","synopsis","posterUrl","genre","createdAt","toDate","updatedAt","error","console","Clock","createLucideIcon","cx","cy","r","key","points","voteQueue","batchTimeout","isProcessingBatch","addVote","_data$commentaire","vote","generateId","filmId","seanceId","note","commentaire","trim","ipAddress","getIpAddress","undefined","userAgent","getUserAgent","sessionId","generateSessionId","Date","voteRef","COLLECTIONS","VOTES","setDoc","Error","addVoteToQueue","user","_data$commentaire2","window","setTimeout","processVoteBatch","checkIfUserVoted","uid","message","length","votesToProcess","batch","writeBatch","set","commit","log","unshift","userId","voteQuery","where","empty","getVoteQueueStatus","pendingVotes","isProcessing","nextBatchIn","getSeanceResults","votesQuery","votes","_voteData$createdAt3","voteData","filmVotes","Object","entries","map","_ref","ratings","distribution","rating","moyenne","Math","round","reduce","sum","totalVotes","moyenneNote","distributionNotes","now","toString","random","substring","navigator","response","fetch","json","ip","warn","setLocalStorage","value","localStorage","setItem","JSON","stringify","getLocalStorage","defaultValue","item","getItem","parse","cn","_len2","arguments","classes","Array","_key2","filter","Boolean","join","MessageSquare","d","CheckCircle","voteSchema","z","min","max","optional","VotePage","useAuth","setFilms","useState","loading","setLoading","selectedFilm","setSelectedFilm","queueStatus","setQueueStatus","existing","newId","register","handleSubmit","setValue","watch","formState","errors","isSubmitting","reset","useForm","resolver","zodResolver","defaultValues","watchedNote","useEffect","filmsData","toast","ERROR_MESSAGES","NETWORK_ERROR","loadFilms","interval","setInterval","status","clearInterval","_jsx","className","children","_jsxs","film","onClick","src","alt","onSubmit","email","success","SUCCESS_MESSAGES","VOTE_PENDING","VOTE_ERROR","star","type","Star","fill","rows","placeholder","maxLength","disabled"],"sourceRoot":""}