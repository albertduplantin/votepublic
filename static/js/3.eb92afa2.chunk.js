/*! For license information please see 3.eb92afa2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkprix_du_public=self.webpackChunkprix_du_public||[]).push([[3],{3003:(e,s,l)=>{l.r(s),l.d(s,{SeanceVotePage:()=>v});var t=l(5043),a=l(3216),r=l(3768),i=l(5469),c=l(5088),n=l(7118),o=l(3944);const d=(0,l(1639).A)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var m=l(7929),x=l(5168),h=l(1146),u=l(3388),j=l(4230),f=l(4413),y=l(579);const v=()=>{const{seanceId:e}=(0,a.g)(),s=(0,a.Zp)(),[l,v]=(0,t.useState)(null),[p,g]=(0,t.useState)([]),[N,b]=(0,t.useState)(null),[w,A]=(0,t.useState)(!0),[k,S]=(0,t.useState)(!1),[V,E]=(0,t.useState)({});(0,t.useEffect)(()=>{(async()=>{if(e)try{A(!0);const[s,l,t]=await Promise.all([(0,m.Si)(e),(0,h.Vm)(),(0,x.MS)(e)]);v(s),g(l),b(t)}catch(l){r.Ay.error("Erreur lors du chargement de la s\xe9ance"),s(f.bw.VOTE)}finally{A(!1)}})()},[e,s]);const C=(e,s,l)=>{E(t=>({...t,[e]:void 0!==l?{filmId:e,note:s,commentaire:l}:{filmId:e,note:s}}))};if(w)return(0,y.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,y.jsx)("p",{className:"mt-4 text-gray-600",children:"Chargement de la s\xe9ance..."})]})});if(!l)return(0,y.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"S\xe9ance non trouv\xe9e"}),(0,y.jsx)(u.$,{onClick:()=>s(f.bw.VOTE),children:"Retour au vote"})]})});const z=p.filter(e=>l.films.includes(e.id));return(0,y.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,y.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,y.jsxs)("div",{className:"mb-8",children:[(0,y.jsx)(u.$,{variant:"ghost",icon:(0,y.jsx)(i.A,{className:"h-4 w-4"}),onClick:()=>s(f.bw.VOTE),className:"mb-4",children:"Retour"}),(0,y.jsx)(j.Z,{className:"mb-6",children:(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:l.nom}),(0,y.jsxs)("div",{className:"flex items-center justify-center space-x-6 text-gray-600",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(c.A,{className:"h-4 w-4"}),(0,y.jsxs)("span",{children:[l.date.toLocaleDateString("fr-FR")," \xe0 ",l.heure]})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(n.A,{className:"h-4 w-4"}),(0,y.jsxs)("span",{children:[z.length," film",z.length>1?"s":""]})]})]}),l.description&&(0,y.jsx)("p",{className:"mt-4 text-gray-600",children:l.description})]})})]}),(0,y.jsx)(j.Z,{className:"mb-8",children:(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Votez pour les films de cette s\xe9ance"}),(0,y.jsx)("p",{className:"text-gray-600 mb-4",children:"Notez chaque film de 1 \xe0 5 \xe9toiles et ajoutez un commentaire optionnel. Vous ne pouvez voter qu'une seule fois par film."}),(0,y.jsxs)("div",{className:"flex items-center justify-center space-x-8 text-sm text-gray-500",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)(o.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,y.jsx)("span",{children:"1 = Tr\xe8s mauvais"})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,y.jsx)(o.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,y.jsx)(o.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,y.jsx)(o.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,y.jsx)(o.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,y.jsx)(o.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,y.jsx)("span",{children:"5 = Excellent"})]})]})]})}),(0,y.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:z.map(e=>{var s;const l=V[e.id],t=null===N||void 0===N||null===(s=N.films)||void 0===s?void 0:s.find(s=>s.filmId===e.id);return(0,y.jsxs)(j.Z,{className:"overflow-hidden",children:[(0,y.jsx)("div",{className:"aspect-[2/3] bg-gray-200 overflow-hidden",children:e.posterUrl?(0,y.jsx)("img",{src:e.posterUrl,alt:e.titre,className:"w-full h-full object-cover"}):(0,y.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:(0,y.jsx)("span",{children:"Aucune image"})})}),(0,y.jsxs)("div",{className:"p-4",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:e.titre}),(0,y.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:e.realisateur}),(0,y.jsxs)("div",{className:"mb-4",children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Votre note :"}),(0,y.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(s=>(0,y.jsx)("button",{type:"button",onClick:()=>C(e.id,s,null===l||void 0===l?void 0:l.commentaire),className:"p-1 rounded transition-colors "+((null===l||void 0===l?void 0:l.note)>=s?"text-yellow-400 hover:text-yellow-500":"text-gray-300 hover:text-yellow-400"),children:(0,y.jsx)(o.A,{className:"h-6 w-6 fill-current"})},s))}),(null===l||void 0===l?void 0:l.note)&&(0,y.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Note : ",l.note,"/5"]})]}),(0,y.jsxs)("div",{className:"mb-4",children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commentaire (optionnel) :"}),(0,y.jsx)("textarea",{value:(null===l||void 0===l?void 0:l.commentaire)||"",onChange:s=>C(e.id,(null===l||void 0===l?void 0:l.note)||0,s.target.value),placeholder:"Votre avis sur ce film...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,maxLength:500})]}),t&&(0,y.jsx)("div",{className:"border-t pt-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,y.jsxs)("span",{children:["Moyenne : ",t.moyenne,"/5"]}),(0,y.jsxs)("span",{children:[t.totalVotes," vote",t.totalVotes>1?"s":""]})]})})]})]},e.id)})}),(0,y.jsx)("div",{className:"mt-8 text-center",children:(0,y.jsx)(u.$,{onClick:async()=>{if(l&&0!==Object.keys(V).length)try{S(!0);const e=Object.values(V).map(e=>(0,x._M)({filmId:e.filmId,seanceId:l.id,note:e.note,...void 0!==e.commentaire?{commentaire:e.commentaire}:{}}));await Promise.all(e),r.Ay.success("Votes enregistr\xe9s avec succ\xe8s !"),s(f.bw.RESULTS)}catch(e){r.Ay.error("Erreur lors de l'enregistrement des votes")}finally{S(!1)}else r.Ay.error("Veuillez voter pour au moins un film")},loading:k,disabled:0===Object.keys(V).length,icon:(0,y.jsx)(d,{className:"h-4 w-4"}),size:"lg",children:k?"Envoi en cours...":`Envoyer ${Object.keys(V).length} vote${Object.keys(V).length>1?"s":""}`})})]})})}},5469:(e,s,l)=>{l.d(s,{A:()=>t});const t=(0,l(1639).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}}]);
//# sourceMappingURL=3.eb92afa2.chunk.js.map