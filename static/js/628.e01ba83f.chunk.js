/*! For license information please see 628.e01ba83f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkprix_du_public=self.webpackChunkprix_du_public||[]).push([[628],{628:(e,s,r)=>{r.r(s),r.d(s,{AdminFilmsPage:()=>p});var t=r(5043),a=r(5475),i=r(5469),n=r(1360),l=r(9292);const c=(0,r(1639).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var d=r(4265),o=r(9855),m=r(1146),x=r(3560),u=r(579);const p=()=>{const[e,s]=(0,t.useState)([]),[r,p]=(0,t.useState)(!0),[h,y]=(0,t.useState)(""),[g,f]=(0,t.useState)(""),{showSuccess:w,showError:j}=(0,x.E)(),b=(0,t.useCallback)(async()=>{try{p(!0);const e=await(0,m.Vm)();s(e)}catch(e){console.error("Erreur lors du chargement des films:",e),j("Erreur de chargement",e.message||"Impossible de charger les films")}finally{p(!1)}},[j]);(0,t.useEffect)(()=>{b()},[b]);const N=e.filter(e=>{const s=e.titre.toLowerCase().includes(h.toLowerCase())||e.realisateur.toLowerCase().includes(h.toLowerCase()),r=!g||e.genre===g;return s&&r}),v=Array.from(new Set(e.map(e=>e.genre))).sort();return r?(0,u.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,u.jsxs)("div",{className:"text-center",children:[(0,u.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,u.jsx)("p",{className:"mt-4 text-gray-600",children:"Chargement des films..."})]})}):(0,u.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,u.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,u.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,u.jsx)("div",{className:"py-6",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,u.jsxs)(a.N_,{to:"/admin",className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[(0,u.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Retour"]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des Films"}),(0,u.jsx)("p",{className:"mt-1 text-gray-600",children:"G\xe9rez les films du festival"})]})]}),(0,u.jsxs)(a.N_,{to:"/admin/films/new",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[(0,u.jsx)(n.A,{className:"w-4 h-4 mr-2"}),"Ajouter un film"]})]})})})}),(0,u.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,u.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-2",children:"Rechercher"}),(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsx)(l.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,u.jsx)("input",{type:"text",id:"search",value:h,onChange:e=>y(e.target.value),placeholder:"Rechercher par titre ou r\xe9alisateur...",className:"pl-10 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"genre",className:"block text-sm font-medium text-gray-700 mb-2",children:"Genre"}),(0,u.jsxs)("select",{id:"genre",value:g,onChange:e=>f(e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[(0,u.jsx)("option",{value:"",children:"Tous les genres"}),v.map(e=>(0,u.jsx)("option",{value:e,children:e},e))]})]}),(0,u.jsx)("div",{className:"flex items-end",children:(0,u.jsxs)("button",{onClick:()=>{y(""),f("")},className:"w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[(0,u.jsx)(c,{className:"w-4 h-4 mr-2"}),"R\xe9initialiser"]})})]})}),(0,u.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,u.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,u.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Films (",N.length,")"]})}),0===N.length?(0,u.jsx)("div",{className:"p-6 text-center text-gray-500",children:(0,u.jsx)("p",{children:"Aucun film trouv\xe9"})}):(0,u.jsx)("div",{className:"overflow-x-auto",children:(0,u.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,u.jsx)("thead",{className:"bg-gray-50",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Film"}),(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"R\xe9alisateur"}),(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Genre"}),(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dur\xe9e"}),(0,u.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ann\xe9e"}),(0,u.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,u.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(r=>(0,u.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)("div",{className:"flex-shrink-0 h-12 w-8",children:r.posterUrl?(0,u.jsx)("img",{className:"h-12 w-8 object-cover rounded",src:r.posterUrl,alt:r.titre}):(0,u.jsx)("div",{className:"h-12 w-8 bg-gray-200 rounded flex items-center justify-center",children:(0,u.jsx)("span",{className:"text-xs text-gray-500",children:"Aucune"})})}),(0,u.jsxs)("div",{className:"ml-4",children:[(0,u.jsx)("div",{className:"text-sm font-medium text-gray-900",children:r.titre}),(0,u.jsx)("div",{className:"text-sm text-gray-500",children:r.pays})]})]})}),(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.realisateur}),(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,u.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:r.genre})}),(0,u.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[r.duree," min"]}),(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.annee}),(0,u.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,u.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,u.jsx)(a.N_,{to:`/admin/films/edit/${r.id}`,className:"text-primary-600 hover:text-primary-900",children:(0,u.jsx)(d.A,{className:"w-4 h-4"})}),(0,u.jsx)("button",{onClick:()=>(async(r,t)=>{if(window.confirm(`\xcates-vous s\xfbr de vouloir supprimer le film "${t}" ?`))try{await(0,m.iE)(r),s(e.filter(e=>e.id!==r)),w("Film supprim\xe9",`Le film "${t}" a \xe9t\xe9 supprim\xe9 avec succ\xe8s`)}catch(a){console.error("Erreur lors de la suppression:",a),j("Erreur de suppression",a.message||"Impossible de supprimer le film")}})(r.id,r.titre),className:"text-red-600 hover:text-red-900",children:(0,u.jsx)(o.A,{className:"w-4 h-4"})})]})})]},r.id))})]})})]})]})]})}},1146:(e,s,r)=>{r.d(s,{Vm:()=>l,iE:()=>d});var t=r(4455),a=r(5472),i=r(8147);r(6925);const n="films",l=async()=>{try{const e=(0,a.P)((0,a.collection)(t.db,n),(0,a.My)("titre","asc")),s=await(0,a.getDocs)(e),r=[];return s.forEach(e=>{const s=e.data();r.push({id:e.id,titre:s.titre,realisateur:s.realisateur,pays:s.pays,duree:s.duree,annee:s.annee,synopsis:s.synopsis,posterUrl:s.posterUrl,genre:s.genre,createdAt:s.createdAt.toDate(),updatedAt:s.updatedAt.toDate()})}),r}catch(e){throw console.error("Erreur lors de la r\xe9cup\xe9ration des films:",e),e}},c=async e=>{try{const s=(0,a.H9)(t.db,n,e),r=await(0,a.x7)(s);if(r.exists()){const e=r.data();return{id:r.id,titre:e.titre,realisateur:e.realisateur,pays:e.pays,duree:e.duree,annee:e.annee,synopsis:e.synopsis,posterUrl:e.posterUrl,genre:e.genre,createdAt:e.createdAt.toDate(),updatedAt:e.updatedAt.toDate()}}return null}catch(s){throw console.error("Erreur lors de la r\xe9cup\xe9ration du film:",s),s}},d=async e=>{try{const s=await c(e);null!==s&&void 0!==s&&s.posterUrl&&await o(s.posterUrl);const r=(0,a.H9)(t.db,n,e);await(0,a.kd)(r)}catch(s){throw console.error("Erreur lors de la suppression du film:",s),s}},o=async e=>{try{const{storage:s}=await Promise.resolve().then(r.bind(r,4455)),t=(0,i.KR)(s,e);await(0,i.XR)(t)}catch(s){console.error("Erreur lors de la suppression du poster:",s)}}},1360:(e,s,r)=>{r.d(s,{A:()=>t});const t=(0,r(1639).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4265:(e,s,r)=>{r.d(s,{A:()=>t});const t=(0,r(1639).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},5469:(e,s,r)=>{r.d(s,{A:()=>t});const t=(0,r(1639).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6925:(e,s,r)=>{r.d(s,{$C:()=>t,$t:()=>i,Lg:()=>c,SP:()=>n,ZB:()=>l,cn:()=>d,f6:()=>a});r(4413);const t=()=>Date.now().toString(36)+Math.random().toString(36).substring(2),a=()=>`${Date.now()}-${Math.random().toString(36).substring(2)}`,i=()=>navigator.userAgent,n=async()=>{try{const e=await fetch("https://api.ipify.org?format=json");return(await e.json()).ip}catch(e){return console.warn("Impossible de r\xe9cup\xe9rer l'IP:",e),null}},l=(e,s)=>{try{localStorage.setItem(e,JSON.stringify(s))}catch(r){console.warn("Erreur lors du stockage local:",r)}},c=(e,s)=>{try{const r=localStorage.getItem(e);return r?JSON.parse(r):s}catch(r){return console.warn("Erreur lors de la r\xe9cup\xe9ration locale:",r),s}},d=function(){for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return s.filter(Boolean).join(" ")}},9292:(e,s,r)=>{r.d(s,{A:()=>t});const t=(0,r(1639).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9855:(e,s,r)=>{r.d(s,{A:()=>t});const t=(0,r(1639).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}}]);
//# sourceMappingURL=628.e01ba83f.chunk.js.map